---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  dpi = 400
)

library(dplyr)
library(ggplot2)

set.seed(0)
```

# PackageBluishgreen

<!-- badges: start -->
[![R-CMD-check](https://github.com/Kevin-Haigis-Lab/PackageBluishgreen/workflows/R-CMD-check/badge.svg)](https://github.com/Kevin-Haigis-Lab/PackageBluishgreen/actions)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->

The goal of `PackageBluishgreen` is to package the internals for clustering cells for Olesja Popow (pronounced "po-pow").
The cells were identified using the TUNEL algorithm which output DAPI and FITC values for each cell into a CSV. 
This package takes these outputs and clusters them by their FITC intensity.

> This package is still under development and the API may change.

## Installation

You can install the released version of 'PackageBluishgreen' from [GitHub](https://github.com/Kevin-Haigis-Lab/PackageBluishgreen) with:

``` r
#> If using 'renv'
renv::install("Kevin-Haigis-Lab/PackageBluishgreen")
#> else
devtools::install_github("Kevin-Haigis-Lab/PackageBluishgreen")
```

## Example

This is a basic example with some data from a lung slide.

```{r example}
library(PackageBluishgreen)

lung_data <- system.file(
  "extdata",
  "unmicst-OP1165_liver_TUNEL_01.csv",
  package = "PackageBluishgreen"
) %>%
  readr::read_csv(col_types = readr::cols()) %>%
  janitor::clean_names() %>%
  select(
    cell_id,
    x = x_centroid,
    y = y_centroid,
    dapi = dapi_nuclei_mask,
    fitc = fitc_nuclei_mask,
    area:orientation
  )

head(lung_data)
```

```{r}
lung_slide <- tissue_slide(lung_data)
```

The slide can store metadata, too.
It can be added to the slide when it is instantiated with `tissue_slide()` using the `metadata` parameter or can be added to an existing tissue slide object using `set_slide_metadata()`

```{r}
lung_slide <- set_slide_metadata(lung_slide, list(tissue = "lung", mouse = "OP24"))
get_slide_metadata(lung_slide)
```

```{r}
plot_tissue(lung_slide, color = log10(fitc))
```

```{r}
plot_density(lung_slide, value = fitc)
```

```{r}
lung_slide <- cluster_manually(lung_slide, fitc, cutoff = 4, transform = log10)
plot_slide_clusters(lung_slide)
```

```{r}
summarize_cluster_results(lung_slide)
```
