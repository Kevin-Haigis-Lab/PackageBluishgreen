<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manual classification • PackageBluishgreen</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Manual classification">
<meta property="og:description" content="PackageBluishgreen">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PackageBluishgreen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/manual-classification.html">Manual classification</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/Kevin-Haigis-Lab/PackageBluishgreen">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="manual-classification_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Manual classification</h1>
            
      
      
      <div class="hidden name"><code>manual-classification.Rmd</code></div>

    </div>

    
    
<p>The following is a simple demonstration of conducting a manual classification of cells into either FITC low or FITC high.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kevin-haigis-lab.github.io/PackageBluishgreen">PackageBluishgreen</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<div id="prepare-data" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-data" class="anchor"></a>Prepare data</h2>
<p>Some example data is shipped with the ‘PackageBluishgreen’ package. They can be accessed using the <code><a href="https://rdrr.io/r/base/system.file.html">system.file()</a></code> function as demonstrated below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"PackageBluishgreen"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "unmicst-OP1165_liver_TUNEL_01.csv"       </span>
<span class="co">#&gt; [2] "unmicst-OP1181_pancreas_TUNEL_01.csv"    </span>
<span class="co">#&gt; [3] "unmicst-OP1513_lung_TUNEL.csv"           </span>
<span class="co">#&gt; [4] "unmicst-OP1704_colon_TUNEL_02.csv"       </span>
<span class="co">#&gt; [5] "unmicst-OP1704_skeletal-muscle_TUNEL.csv"</span></code></pre></div>
<p>We will use the pancreas data set from mouse OP1181.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pancreas_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span>
  <span class="st">"extdata"</span>,
  <span class="st">"unmicst-OP1181_pancreas_TUNEL_01.csv"</span>,
  package <span class="op">=</span> <span class="st">"PackageBluishgreen"</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   CellID = col_double(),</span>
<span class="co">#&gt;   DAPI_nucleiMask = col_double(),</span>
<span class="co">#&gt;   FITC_nucleiMask = col_double(),</span>
<span class="co">#&gt;   X_centroid = col_double(),</span>
<span class="co">#&gt;   Y_centroid = col_double(),</span>
<span class="co">#&gt;   column_centroid = col_double(),</span>
<span class="co">#&gt;   row_centroid = col_double(),</span>
<span class="co">#&gt;   Area = col_double(),</span>
<span class="co">#&gt;   MajorAxisLength = col_double(),</span>
<span class="co">#&gt;   MinorAxisLength = col_double(),</span>
<span class="co">#&gt;   Eccentricity = col_double(),</span>
<span class="co">#&gt;   Solidity = col_double(),</span>
<span class="co">#&gt;   Extent = col_double(),</span>
<span class="co">#&gt;   Orientation = col_double()</span>
<span class="co">#&gt; )</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pancreas_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 14</span>
<span class="co">#&gt;   CellID DAPI_nucleiMask FITC_nucleiMask X_centroid Y_centroid column_centroid</span>
<span class="co">#&gt;    &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1          37342.           6472.      1026.       3.30           1026.</span>
<span class="co">#&gt; 2      2          14341.           6447.      1223.       3.34           1223.</span>
<span class="co">#&gt; 3      3          22004.           3979.      1429.       4.83           1429.</span>
<span class="co">#&gt; 4      4          15927.           4363.      1539.       4.36           1539.</span>
<span class="co">#&gt; 5      5          26581.           5615.      1598.       7.38           1598.</span>
<span class="co">#&gt; 6      6          16426.           5169.      1732.       1.74           1732.</span>
<span class="co">#&gt; # … with 8 more variables: row_centroid &lt;dbl&gt;, Area &lt;dbl&gt;,</span>
<span class="co">#&gt; #   MajorAxisLength &lt;dbl&gt;, MinorAxisLength &lt;dbl&gt;, Eccentricity &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Solidity &lt;dbl&gt;, Extent &lt;dbl&gt;, Orientation &lt;dbl&gt;</span></code></pre></div>
<p>We should first clean the column names and reduce clutter by keeping only the columns we will use.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pancreas_data</span> <span class="op">&lt;-</span> <span class="va">pancreas_data</span> <span class="op">%&gt;%</span>
  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>
    <span class="va">cell_id</span>,
    x <span class="op">=</span> <span class="va">x_centroid</span>,
    y <span class="op">=</span> <span class="va">y_centroid</span>,
    fitc <span class="op">=</span> <span class="va">fitc_nuclei_mask</span>
  <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pancreas_data</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt;   cell_id     x     y  fitc</span>
<span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1       1 1026.  3.30 6472.</span>
<span class="co">#&gt; 2       2 1223.  3.34 6447.</span>
<span class="co">#&gt; 3       3 1429.  4.83 3979.</span>
<span class="co">#&gt; 4       4 1539.  4.36 4363.</span>
<span class="co">#&gt; 5       5 1598.  7.38 5615.</span>
<span class="co">#&gt; 6       6 1732.  1.74 5169.</span></code></pre></div>
</div>
<div id="create-a-tissue-slide-data-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-tissue-slide-data-structure" class="anchor"></a>Create a tissue slide data structure</h2>
<p>First, we must make a tissue slide object. We can then apply a manual classification (or any other support methods) to this object. The tissue slide can also hold metadata.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pancreas_slide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tissue_slide.html">tissue_slide</a></span><span class="op">(</span><span class="va">pancreas_data</span>, metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>tissue <span class="op">=</span> <span class="st">"pancreas"</span>, mouse <span class="op">=</span> <span class="st">"OP1181."</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/get_slide_metadata.html">get_slide_metadata</a></span><span class="op">(</span><span class="va">pancreas_slide</span><span class="op">)</span>
<span class="co">#&gt; $tissue</span>
<span class="co">#&gt; [1] "pancreas"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mouse</span>
<span class="co">#&gt; [1] "OP1181."</span></code></pre></div>
</div>
<div id="visualize-signal-intensity" class="section level2">
<h2 class="hasAnchor">
<a href="#visualize-signal-intensity" class="anchor"></a>Visualize signal intensity</h2>
<p>The next step is to visualize the data. We can use the <code><a href="../reference/plot_tissue.html">plot_tissue()</a></code> function to plot the cells on the slide, colored by their FITC intensity.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_tissue.html">plot_tissue</a></span><span class="op">(</span><span class="va">pancreas_slide</span>, color <span class="op">=</span> <span class="va">fitc</span><span class="op">)</span></code></pre></div>
<p><img src="manual-classification_files/figure-html/unnamed-chunk-6-1.png" width="1458.33333333333"></p>
<p>It often helps to log-transform the signal intensity.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_tissue.html">plot_tissue</a></span><span class="op">(</span><span class="va">pancreas_slide</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fitc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="manual-classification_files/figure-html/unnamed-chunk-7-1.png" width="1458.33333333333"></p>
<p>We can also see the distribution of FITC intensities using the <code><a href="../reference/plot_density.html">plot_density()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span><span class="va">pancreas_slide</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">fitc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="manual-classification_files/figure-html/unnamed-chunk-8-1.png" width="1458.33333333333"></p>
</div>
<div id="manual-classification" class="section level2">
<h2 class="hasAnchor">
<a href="#manual-classification" class="anchor"></a>Manual classification</h2>
<p>For this example, our goal is to just capture the top percent of the cells, those that are deep red in the image above. Judging from the plot, it looks like a value just above <span class="math inline">\(log_{10} 4.3\)</span> should work. The classification can be applied to the lung slide using the <code><a href="../reference/cluster_manually.html">cluster_manually()</a></code> function. Note that the transform function must be passed to the <code>transform</code> parameter so it can be used in other operations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pancreas_slide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_manually.html">cluster_manually</a></span><span class="op">(</span><span class="va">pancreas_slide</span>, <span class="va">fitc</span>, <span class="fl">4.3</span>, transform <span class="op">=</span> <span class="va">log10</span><span class="op">)</span></code></pre></div>
<p>The classification results can be visualized using the <code>()</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_slide_clusters.html">plot_slide_clusters</a></span><span class="op">(</span><span class="va">pancreas_slide</span>, method <span class="op">=</span> <span class="st">"manual"</span><span class="op">)</span></code></pre></div>
<p><img src="manual-classification_files/figure-html/unnamed-chunk-10-1.png" width="1458.33333333333"></p>
</div>
<div id="summarize-results" class="section level2">
<h2 class="hasAnchor">
<a href="#summarize-results" class="anchor"></a>Summarize results</h2>
<p>A summary of the classification results can be obtained using the <code><a href="../reference/summarize_cluster_results.html">summarize_cluster_results()</a></code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summarize_cluster_results.html">summarize_cluster_results</a></span><span class="op">(</span><span class="va">pancreas_slide</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   manual_cluster     n</span>
<span class="co">#&gt; * &lt;fct&gt;          &lt;int&gt;</span>
<span class="co">#&gt; 1 1              66244</span>
<span class="co">#&gt; 2 2                787</span></code></pre></div>
<hr>
<p>Mistakes or questions? Open an <a href="https://github.com/Kevin-Haigis-Lab/PackageBluishgreen/issues">issue</a> on Github.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joshua Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
